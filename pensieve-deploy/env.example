# Pensieve Production Environment
# Copy to .env and edit values:
#   cp env.example .env
#   nano .env

# ═══════════════════════════════════════════════════════════════════════════
# Domains / Reverse Proxy
# ═══════════════════════════════════════════════════════════════════════════
# For local development, use localhost (HTTP only)
# For production, use your domains (Caddy will auto-provision HTTPS for both)
DOMAIN=localhost
# DOMAIN=api.example.com

# Preview domain (separate domain for public Nostr event preview pages)
PREVIEW_DOMAIN=localhost:8081
# PREVIEW_DOMAIN=preview.example.com

# ═══════════════════════════════════════════════════════════════════════════
# ClickHouse
# ═══════════════════════════════════════════════════════════════════════════
CLICKHOUSE_URL=http://localhost:8123
CLICKHOUSE_DB=nostr

# Password for the read-only 'grafana' user (used by Grafana dashboards)
# Generate a secure password: openssl rand -base64 24
CLICKHOUSE_GRAFANA_PASSWORD=changeme

# ═══════════════════════════════════════════════════════════════════════════
# API Server (pensieve-serve)
# ═══════════════════════════════════════════════════════════════════════════
# Server bind address
PENSIEVE_BIND_ADDR=0.0.0.0:8080

# API tokens (comma-separated). Each user/client should have their own token.
# Generate tokens with: openssl rand -hex 32
PENSIEVE_API_TOKENS=your-secret-token-here

# ═══════════════════════════════════════════════════════════════════════════
# Preview Server (pensieve-preview)
# ═══════════════════════════════════════════════════════════════════════════
# Server bind address
PREVIEW_BIND_ADDR=0.0.0.0:8081

# Base URL for canonical links and OG tags (no trailing slash)
# PREVIEW_BASE_URL=https://pensieve.example.com
PREVIEW_BASE_URL=http://localhost:8081

# Site name shown in page titles and OG tags
PREVIEW_SITE_NAME=Nostr Preview

# VIP pubkeys (comma-separated hex) that get extended cache TTLs (optional)
# PREVIEW_VIP_PUBKEYS=82341f882b6eabcd...,04c915daefee3831...

# ═══════════════════════════════════════════════════════════════════════════
# Ingester
# ═══════════════════════════════════════════════════════════════════════════
ROCKSDB_PATH=/data/rocksdb
ARCHIVE_PATH=/archive/segments
SEGMENT_SIZE=268435456  # 256 MB

# ═══════════════════════════════════════════════════════════════════════════
# Storage Box (for remote archive sync)
# ═══════════════════════════════════════════════════════════════════════════
STORAGE_BOX_HOST=uXXXXXX.your-storagebox.de
STORAGE_BOX_USER=uXXXXXX
STORAGE_BOX_PATH=pensieve/archive

# How many days to keep segments locally before allowing deletion
LOCAL_RETENTION_DAYS=30

# Disk usage threshold (%) to trigger cleanup of old local segments
DISK_CLEANUP_THRESHOLD=80

# ═══════════════════════════════════════════════════════════════════════════
# Monitoring (optional)
# ═══════════════════════════════════════════════════════════════════════════
# GRAFANA_PASSWORD=changeme

# ═══════════════════════════════════════════════════════════════════════════
# Backfill (for S3 source)
# ═══════════════════════════════════════════════════════════════════════════
# AWS_ACCESS_KEY_ID=
# AWS_SECRET_ACCESS_KEY=
# AWS_REGION=us-east-1
# S3_BUCKET=
# S3_PREFIX=

